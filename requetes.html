<!doctype html>
<html lang="fr">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
   <link rel="stylesheet" href="css/bootstrap.css">

    <title>SQL COURS</title>
  </head>

  <body>
<div class="container-fluid">
    <!-- ========================================= -->
    <!--                navigation                 -->
    <!-- ========================================= -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#">cours SQL</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    <a class="nav-link active" aria-current="page" href="index.html">Accueil</a>
                    <a class="nav-link" href="requetes.html">Les requetes MySQL</a>
                    <a class="nav-link" href="#">Menu 2</a>
                    <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Menu 3 - Disabled</a>
                </div>
            </div>
        </div>
    </nav>
</div>
<div class="container">


         <!-- **********************************************-->
         <!--               Contenu principal               -->
         <!-- **********************************************-->

    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <h1 class="text-center">Les requêtes MySQL</h1>
            </div> <!-- fin col -->
        </div><!-- fin row -->
        <div class="row">
            <h2>Créer une base de donnée - <code>CREATE DATABASE basetest CHARACTER SET 'utf8';</code></h2>
            
        </div>

        <div class="row">
            <div class="col-sm-12">
                <ul>
                    <li>Créer une BDD
                        <code> CREATE DATABASE basetest CHARACTER SET 'utf8';</code>
                    </li>
                    <li>Voir les BDD dans le serveur
                        <code>SHOW DATABASES;</code
                            ></li>
                    <li>Utiliser une base de donnée
                        <code>USE basetest;</code>
                    </li>
                    <li>Supprimer une BDD
                        <code>DROP DATABASE IF EXISTS basetest;</code>
                    </li>
                    <li>Créer une table dans la base 'entreprise' :
                        <code>CREATE TABLE IF NOT EXISTS employes (id_employes int(3) NOT NULL AUTO_INCREMENT, 
                        prenom varchar(20) DEFAULT NULL, 
                        nom varchar(20) DEFAULT NULL, 
                        sexe enum('m', 'f') NOT NULL, 
                        service varchar(30) DEFAULT NULL, 
                        date_embauche date DEFAULT NULL, 
                        salaire float DEFAULT NULL, 
                        PRIMARY KEY (id_employes) 
                        ) ENGINE=InnoDB DEFAULT CHARSET=latin1;
                        </code>
                    </li>
                    <li>Inserer des données dans la table employés
                        <code>INSERT INTO employes (id_employes, prenom, nom, sexe, service, date_embauche, salaire) VALUES
                            (350, 'Jean-pierre', 'Laborde', 'm', 'direction', '1999-12-09', 5000),
                            (388, 'Clement', 'Gallet', 'm', 'commercial', '2000-01-15', 2300),
                            (415, 'Thomas', 'Winter', 'm', 'commercial', '2000-05-03', 3550),
                            (417, 'Chloe', 'Dubar', 'f', 'production', '2001-09-05', 1900),
                            (491, 'Elodie', 'Fellier', 'f', 'secretariat', '2002-02-22', 1600),
                            (509, 'Fabrice', 'Grand', 'm', 'comptabilite', '2003-02-20', 1900),
                            (547, 'Melanie', 'Collier', 'f', 'commercial', '2004-09-08', 3100),
                            (592, 'Laura', 'Blanchet', 'f', 'direction', '2005-06-09', 4500),
                            (627, 'Guillaume', 'Miller', 'm', 'commercial', '2006-07-02', 1900),
                            (655, 'Celine', 'Perrin', 'f', 'commercial', '2006-09-10', 2700),
                            (699, 'Julien', 'Cottet', 'm', 'secretariat', '2007-01-18', 1390),
                            (701, 'Mathieu', 'Vignal', 'm', 'informatique', '2008-12-03', 2000),
                            (739, 'Thierry', 'Desprez', 'm', 'secretariat', '2009-11-17', 1500),
                            (780, 'Amandine', 'Thoyer', 'f', 'communication', '2010-01-23', 1500),
                            (802, 'Damien', 'Durand', 'm', 'informatique', '2010-07-05', 2250),
                            (854, 'Daniel', 'Chevel', 'm', 'informatique', '2011-09-28', 1700),
                            (876, 'Nathalie', 'Martin', 'f', 'juridique', '2012-01-12', 3200),
                            (900, 'Benoit', 'Lagarde', 'm', 'production', '2013-01-03', 2550),
                            (933, 'Emilie', 'Sennard', 'f', 'commercial', '2014-09-11', 1800),
                            (990, 'Stephanie', 'Lafaye', 'f', 'assistant', '2015-06-02', 1775);</code>
                    </li>
                    <li>Afficher des données : SELECT</li>
                    <li>Afficher les donné nom et prénom d'employés :
                        <code>SELECT nom, prenom FROM employes;</code>
                    </li>
                </ul>
                <h3>Le mot clef DINSTINCT</h3>
                <ul>
                    <li>Afficher les services occupés dans l'entreprise : <code></code></li>
                    <li>Eviter les doublon grâce à DINSTINCT :  <code>SELECT DINSTINCT (service) FROM employes;</code></li>
                </ul>
                <h3>Les requêtes ne sont pas sensible à la casse, mais !!!</h3>
                <p>Une convention indique qu'il faut mettre les mots-cléfs des requêtes en majuscule</p>
                <ul>
                    <li>Ces deux requêtes sont identiques : * = all, tout</li>
                    <li><code>SELECT id_employes, prenom, nom, sexe, service, date_embauche, salaire FROM employes;</code></li>
                    <li><code>SELECT * FROM employes;</code></li>
                </ul>
                <h3>Les conditions : le mot-clef WHERE</h3>
                <p>Nous cherchons avec une condition une partie des données</p>
                <ul>
                    <li><code>SELECT nom, prenom FROM employes WHERE service='informatique";</code></li>
                    <li>ou l'employé dont le prénom est Thomas : <code>SELECT nom, prenom FROM employes WHERE prenom='Thomas';</code></li>
                </ul>
                <h3>Le mot-clef BETWEEN</h3>
                <p>Afficher les employés ayant été recrutés entre 2006 et 2010</p>
                <ul>
                    <li><code>SELECT * FROM employes WHERE date_embauche BETWEEN '2006-01-01' AND '2010-12-31';</code></li>
                    <li><code>SELECT nom, prenom, date_embauche FROM employes WHERE date_embache BETWEEN 'aaaa-mm-jj' AND 'aaaa-mm-jj';</code></li>
                    <li>Une requête quidonne la date du serveur <code>SELECT curdate();</code></li>
                </ul>
                <h3>Le mot-clef LIKE</h3>
                <p>Afficher les employes dont le prénom commance par S</p>
                <p>Avec la présence du caractère % avant et/ou après la lettre ou le mot recherché, nous demandons au système de trouver des enregistrements contenant l'expression recherchée.</p>
                <ul>
                    <li><code>SELECT * FROM employes WHERE prenom LIKE 's%';</code> Commancent par</li>
                    <li><code>SELECT * FROM employes WHERE prenom LIKE 's%';</code> Finissant par</li>
                    <li><code>SELECT * FROM employes WHERE prenom LIKE '%s%';</code> Comportant la lettre</li>
                    <li><code>SELECT * FROM employes WHERE prenom LIKE '%-%';</code> Comportant les noms composés</li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h2>Les opérateurs de comparaison</h2>
            </div>
            <div class="col-12">
                <h2>Les opérateurs de comparaison</h2>
                <table class="table table-striped">
                    <thead>
                      <tr>
                        <th scope="col">Opérateur</th>
                        <th scope="col">Symbole</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th scope="row">=</th>
                        <td>est égal</td>
                      </tr>
                      <tr>
                        <th scope="row">&gt;</th>
                        <td>strictement supérieur</td>
                      </tr>
                      <tr>
                        <th scope="row">&lt;</th>
                        <td>strictement inférieur</td>
                      </tr>
                      <tr>
                        <th scope="row">&gt;=</th>
                        <td>supérieur ou égal</td>
                      </tr>
                      <tr>
                        <th scope="row">&lt;=</th>
                        <td>inférieur ou égal</td>
                      </tr>
                      <tr>
                        <th scope="row">&lt; &gt; ou !=</th>
                        <td>est différent</td>
                      </tr>
                    </tbody>
                  </table>
            </div>
            <h2>L'opérateur !=</h2>
            <ul>
                <li>Tous les employés qui ne sont pas au service informatique <code> SELECT * FROM employes WHERE service !="informatique";</code></li>
            </ul>
            <h3>L'opérateur &gt;</h3>
            <ul>
                <li>Tous les employés gagnant plus de 3000 Euros <code></code></li>
            </ul>
        </div> <!-- fin row -->
        <div class="row">
            <div class="col-12">
                <h2>Le classement avec ORDER BY</h2>
            </div>
            <div>
                <ul>
                    <li>Les employés triés par nom de famille et par odre alphabétique <code>SELECT prenom, nom FROM employes ORDER BY nom;</code></li>
                    <li>Par odre (ASC) ascendent <code>SELECT prenom, nom FROM employes ORDER BY nom ASC;</code></li>
                    <li>Par odre (DESC) déscendent<code>SELECT prenom, nom FROM employes ORDER BY nom DESC;</code></li>
                    <li>----</li>
                    <li>Trier sur plusieurs colonnes <code>SELECT prenom, nom, service, salaire FROM employes ORDER BY service ASC, salaire ASC; </code></li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h2>Limiter les résultats avec le mot-clef LIMIT</h2>
            </div>
            <div>
                <ul>
                    <li>Afficher les employés en les classant par salaire (du + grand au plus petit) et en les affichants par 3 <code>SELECT nom, prenom, service, salaire FROM employes ORDER BY salaire DESC LIMIT 3;</code></li>
                    <li>Afficher les employés en les classant par salaire <code>SELECT nom, prenom, service, salaire FROM employes ORDER BY salaire DESC LIMIT 5,3;</code> Le premier chiffre nous indique à partir de quel numéro partira le comptage et le second affiche le nombre de resultats que l'on souhaite obtenir.</li>
                    <li>Le mot-clef LIMIT est utile pour faire une pagination web</li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h2>Réaliser des calculs dans nos requêtes</h2>
            </div>
            <div>
                <ul>
                    <li>Afficher la liste des employés avec leur salaire annuel</li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h2>Utiliser un alias avec AS</h2>
            </div>
            <div class="col-12">
                <ul>
                    <li>SELECT nom, prenom, salaire, salaire*12 AS salaire_annuel FROM employes ORDER BY salaire_annuel DESC;</li>
                    <li>Le mot-cléf As permet de définir un alias</li>
                </ul>
            </div>
            <div class="col-12">
                <h3>Calculer une somme avec SUM et une moyenne avec AVG</h3>
            </div>
            <div class="col-12">
                <li><code>SELECT SUM(salaire*12) FROM employes;</code></li>
                <li><code>SELECT AVG(salaire*12) FROM employes;</code></li>
            </div>
            <div class="col-12">
                <h3>Arrondir avec ROUND</h3>
            </div>
            <div class="col-12">
                <li>Arrondir un calcul <code>SELECT ROUND(AVG(salaire)) FROM employes;</code></li>
                <li><code>SELECT AVG(salaire*12) FROM employes;</code></li>
                <li>Faire un alias <code>SELECT ROUND (AVG(salaire)) AS moyen_mensuelle FROM employes;</code></li>
            </div>
            <div class="col-12">
                <h3>Compter avec COUNT</h3>
            </div>
            <div class="col-12">
                <ul>
                    <li>Compter le nombre d'employées : <code>SELECT COUNT(*) FROM employes WHERE sexe='f';</code></li>
                </ul>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <h2>Isoler une valeur minimum ou maximum avec MIN ou MAX</h2>
            </div>
            <div class="col-12">
                <ul>
                    <li>Trouver le salaire minimum :<code> SELECT MIN(salaire) FROM employes;</code></li>
                    <li>Trouver le salaire maximum :<code> SELECT MAX(salaire) FROM employes;</code></li>
                    <li>Trouver le salaire maximum :<code> SELECT prenom, nom MIN(salaire) FROM employes;</code> <br> Cette requête ne fonctionne pas, pour le trouver le salaire et la personne qui gagne il faut écrire <code>SELECT prenom, salaire FROM employes WHERE salaire = (SELECT MIN(salaire) FROM employes);</code> : Le ststeme va d'abord exécuter la requête entre pareenthèse pour connaitre le résultat et l'utiliser  comme source pour l'autre requête</li>
                    <li>Trouver le salaire maximum : <code>SELECT prenom, salaire FROM employes WHERE salaire = (SELECT MAX(salaire) FROM employes);</code> Cela s'appelle une requête imbriquée.</li>
                    <li>Trouver qui gagne 1390€ <code>SELECT prenom, nom, salaire FROM employes WHERE salaire = 1390;
                    </code></li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h2>Condition In avec plusieurs valeurs</h2>
            </div>
            <div class="col-12">
                <ul>
                    <li>Trouver les employés à la compatibilité et au service informatique <code>SELECT prenom, nom, service FROM employes WHERE service IN('comptabilite','informatique');</code> </li>
                    <li>= permet d'annoncer 1 seul valeur</li>
                    <li>IN permet d'annoncer plusieurs valeurs</li>
                    <li>Trouver les employés qui ne sont pas au service informatique et à la comptabilité avec NOT IN<code>SELECT nom, prenom, service FROM employes WHERE service NOT IN ('comptabilité', 'informatique') ORDER BY service;</code></li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h2>Condition Multiple, différents champs et valeurs</h2>
            </div>
            <div class="col-12">
                <ul>
                    <li>SELECT nom, prenom, salaire, service FROM employes WHERE service = 'commercial' AND salaire <= 2000;</li>
                </ul>
            </div>
            <div class="col-12">
                <h3>Ordre de priorité sur les conditions AND et OR</h3>
            </div>
            <div class="col-12">
                <ul>
                    <li><code>SELECT nom, prenom, service, salaire FROM employes WHERE service ='production' AND salaire= 1900 OR salaire = 2300;</code></li>
                    <li>Lorsqu'il y a AND et OR au sein de la même requête, le système lit la condition de la droite vers la gauche et il verra d'abord <code>salaire = 1900 OR salaire = 2300</code> et ensuite le service <code>service='production'</code></li>
                    <li>Pour garentir l'ordre naturel de lecture (de la gauche vers la droite) on utilisera les pareenthèse : <code>SELECT nom, prenom, service, salaire FROM employes WHERE service ='production' AND salaire= 1900 OR salaire = 2300;</code></li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h2>Les regroupement avec GROUP BY</h2>
            </div>
            <div class="col-12">
                <ul>
                    <li>Si l'on veut connaître le nombre d'employés par service : <code>SELECT service, COUNT(*) AS nombre_employes FROM employes GROUP BY service;</code></li>
                </ul>
            </div>
            <div class="col-12">
                <ul>
                    <li><code>SELECT service, COUNT(*) AS nombre_employes FROM employes GROUP BY service HAVING COUNT(*) > 2;</code></li>
                    <li></li>
                </ul>
            </div>
        </div>
        <hr>
        <div class="row bg-info">
            <div class="col-12 ">
                <h2>Les requêtes d'insertion avec INSERT</h2>
            </div>
            <div class="col-12">
                <ul>
                    <li>Insérer un enregistrement : <code>INSERT INTO employes(prenom, nom, sexe, service, date_embauche, salaire) VALUES ('Alexis', 'Richy', 'm', 'informatique', '2011-12-28', 1800);</code> </li>
                    <li>Insérer un enregistrement : 2nde méthode <code>INSERT INTO employes VALUES (NULL, 'Patrick', 'Isola', 'm','Professeur', '2020-06-01', 2000); </code>NULL nous permet de laisser le champs id_employes se remplir seul car il est auto-incrémenté</li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h2>Les requetes de modification avec UPDATE</h2>
            </div>
            <div class="col-12">
                <ul>
                    <li>Augmenter le salaire d'un employé: <code>UPDATE employes SET salaire = 1871 WHERE id_employes = 990;</code></li>
                    <li>Il est recommandé de modifier un enregistrement en ciblant son ID, l'ID étant unique</li>
                    <li>Mettre a jour plusieurs information <code>UPDATE employes SET service = 'informatique', salaire = 2500 WHERE id_employes = 990;</code></li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h2>Supprimer un enregistrement avec DELETE</h2>
            </div>
            <div class="col-12">
                <ul>
                    <li> Supprimer un enregistrement; <code>DELETE FROM employes WHERE id_employes = 388;</code></li>
                    <li> Supprimer plusieurs Enregistrements; <code>DELETE FROM employes WHERE service = 'informatique';</code></li>
                </ul>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <h2>EXERCICE</h2>
            </div>
            <div class="col-12">
                <ol>
                    <li>Afficher la profession de l'employé  : <code>SELECT service FROM employes WHERE id_employes = 547;</code></li>

                    <li>Afficher la date d'embauche d'amandine: <code>SELECT date_embauche FROM employes WHERE prenom = 'amandine';</code></li>

                    <li>Afficher le nombre de commerciaux : <code>SELECT * FROM employes WHERE service = 'commercial';</code></li>

                    <li>Afficher le coût des commerciaux sur 1 année : <code>SELECT (SUM(salaire*12)) AS moyen_annuel FROM employes WHERE service = 'commercial';</code></li>

                    <li>Afficher le salaire moyen par service : <code>SELECT service, ROUND (AVG(salaire)) AS 'cout_moyen' FROM employes GROUP BY service;</code></li>

                    <li>Afficher le nombre de recrutements sur l'année 2010 : <code>SELECT COUNT(*) AS 'nbr de recrutement 2010' FROM employes WHERE date_embauche BETWEEN '2010-01-01' AND '2010-12-31';</code> ou <code>SELECT COUNT(*) AS 'nb de recrutement en 2010' FROM employes WHERE date_embauche LIKE '2010%';</code> ou <code></code></li>

                    <li>Augmenter le salaire pour chaque employé de 100 € : <code>UPDATE employes SET salaire = salaire + 100 ;</code></li>

                    <li>Afficher le nombre de services (différents) : <code></code></li>

                    <li>Afficher les informations de l'employé du service commercial gagnant le salaire le plus élevé : <code></code></li>

                    <li>Afficher l'employé ayant été embauché en dernier : <code></code></li>
                </ol>
            </div>
        </div>

       
    </div> <!-- fin container secondaire -->
    
</div> <!-- fin container principal -->



<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

<!--***********************************************-->
<!--              jQuery en local                  -->
<!-- **********************************************-->   
<script src="jquery/jquery-3.5.1.js"></script>

<!--***********************************************-->
<!--                Popper en local                -->
<!-- **********************************************-->
<script src="js/popper.min.js"></script>

<!-- **********************************************-->
<!--             Boostrap JS en local              -->
<!-- **********************************************--> 
  <script src="js/bootstrap.js"></script>

<!-- **********************************************-->
<!--             JavaScript LOCAL                  -->
<!-- **********************************************--> 


  </body>
</html>